<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NIFTY ORB Strategy: Original vs Tuned</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
  :root {
    --orig: #e74c3c;
    --tuned: #2ecc71;
    --bg: #0f1117;
    --card: #1a1d28;
    --border: #2a2d3a;
    --text: #e0e0e0;
    --muted: #8892a0;
    --accent: #3b82f6;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }

  .container { max-width: 1400px; margin: 0 auto; padding: 24px; }

  header { text-align: center; padding: 40px 0 20px; }
  header h1 { font-size: 2.2rem; font-weight: 700; margin-bottom: 8px; }
  header p { color: var(--muted); font-size: 1.1rem; }

  /* Strategy explanation */
  .strategy-flow { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 32px; margin: 24px 0; }
  .strategy-flow h2 { font-size: 1.4rem; margin-bottom: 20px; color: var(--accent); }

  .flow-steps { display: flex; gap: 12px; overflow-x: auto; padding: 8px 0; }
  .flow-step { flex: 1; min-width: 180px; background: #222639; border-radius: 8px; padding: 16px; text-align: center; position: relative; }
  .flow-step::after { content: '\2192'; position: absolute; right: -16px; top: 50%; transform: translateY(-50%); font-size: 1.4rem; color: var(--muted); }
  .flow-step:last-child::after { display: none; }
  .flow-step .step-num { display: inline-block; width: 28px; height: 28px; line-height: 28px; border-radius: 50%; background: var(--accent); color: white; font-weight: 700; font-size: 0.85rem; margin-bottom: 8px; }
  .flow-step h4 { font-size: 0.95rem; margin-bottom: 6px; }
  .flow-step p { font-size: 0.8rem; color: var(--muted); }

  /* Parameter comparison */
  .params-section { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin: 24px 0; }
  .param-card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; }
  .param-card h3 { font-size: 1.2rem; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
  .param-card h3 .dot { width: 12px; height: 12px; border-radius: 50%; display: inline-block; }
  .param-card.original h3 .dot { background: var(--orig); }
  .param-card.tuned h3 .dot { background: var(--tuned); }

  .param-table { width: 100%; border-collapse: collapse; }
  .param-table td { padding: 8px 12px; border-bottom: 1px solid var(--border); font-size: 0.9rem; }
  .param-table td:first-child { color: var(--muted); width: 55%; }
  .param-table td:last-child { font-weight: 600; text-align: right; }
  .param-table tr.changed td:last-child { color: #f1c40f; }

  /* Metrics comparison */
  .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin: 24px 0; }
  .metric-tile { background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 20px; text-align: center; }
  .metric-tile .label { font-size: 0.8rem; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 10px; }
  .metric-tile .values { display: flex; justify-content: center; gap: 24px; }
  .metric-tile .val { font-size: 1.5rem; font-weight: 700; }
  .metric-tile .val.orig { color: var(--orig); }
  .metric-tile .val.tuned { color: var(--tuned); }
  .metric-tile .val-label { font-size: 0.7rem; color: var(--muted); }
  .metric-tile .improvement { font-size: 0.85rem; margin-top: 8px; padding: 3px 10px; border-radius: 12px; display: inline-block; }
  .metric-tile .improvement.positive { background: rgba(46,204,113,0.15); color: var(--tuned); }
  .metric-tile .improvement.negative { background: rgba(231,76,60,0.15); color: var(--orig); }

  /* Charts */
  .chart-section { margin: 32px 0; }
  .chart-section h2 { font-size: 1.3rem; margin-bottom: 16px; color: var(--accent); }
  .chart-container { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin-bottom: 24px; }
  .chart-container canvas { max-height: 350px; }

  /* Trailing ladder visual */
  .ladder-section { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin: 24px 0; }
  .ladder-card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; }
  .ladder-card h3 { margin-bottom: 16px; font-size: 1.1rem; }
  .ladder-visual { position: relative; }
  .ladder-rung { display: flex; align-items: center; margin: 8px 0; font-size: 0.85rem; }
  .ladder-bar { height: 32px; border-radius: 6px; display: flex; align-items: center; padding: 0 12px; font-weight: 600; color: white; font-size: 0.8rem; transition: width 0.6s ease; }
  .ladder-label { width: 90px; text-align: right; padding-right: 12px; color: var(--muted); font-size: 0.8rem; }
  .ladder-action { margin-left: 12px; font-size: 0.8rem; color: var(--muted); }

  /* Trade table */
  .trade-table-wrapper { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin: 24px 0; overflow-x: auto; }
  .trade-table-wrapper h3 { margin-bottom: 12px; }
  .tab-buttons { display: flex; gap: 8px; margin-bottom: 16px; }
  .tab-btn { padding: 8px 20px; border: 1px solid var(--border); background: transparent; color: var(--muted); border-radius: 6px; cursor: pointer; font-size: 0.9rem; transition: all 0.2s; }
  .tab-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
  .tab-btn:hover { border-color: var(--accent); }

  table.trades { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
  table.trades th { text-align: left; padding: 10px 8px; border-bottom: 2px solid var(--border); color: var(--muted); font-weight: 600; }
  table.trades td { padding: 8px; border-bottom: 1px solid var(--border); }
  table.trades tr:hover { background: rgba(59,130,246,0.05); }
  .pnl-pos { color: var(--tuned); font-weight: 600; }
  .pnl-neg { color: var(--orig); font-weight: 600; }
  .badge { padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; }
  .badge-call { background: rgba(46,204,113,0.15); color: var(--tuned); }
  .badge-put { background: rgba(231,76,60,0.15); color: var(--orig); }
  .badge-exit { background: rgba(59,130,246,0.1); color: var(--accent); }

  /* Exit reason donut */
  .exit-section { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin: 24px 0; }
  .exit-card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; text-align: center; }
  .exit-card h3 { margin-bottom: 12px; }
  .exit-card canvas { max-height: 250px; }

  /* Key insight boxes */
  .insights { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; margin: 24px 0; }
  .insight-box { background: var(--card); border-left: 4px solid var(--accent); border-radius: 0 8px 8px 0; padding: 16px 20px; }
  .insight-box h4 { font-size: 0.95rem; margin-bottom: 6px; }
  .insight-box p { font-size: 0.85rem; color: var(--muted); }

  .legend { display: flex; justify-content: center; gap: 32px; margin: 16px 0; }
  .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; }
  .legend-dot { width: 14px; height: 14px; border-radius: 3px; }

  @media (max-width: 768px) {
    .params-section, .ladder-section, .exit-section { grid-template-columns: 1fr; }
    .flow-steps { flex-direction: column; }
    .flow-step::after { display: none; }
  }
</style>
</head>
<body>

<div class="container">

<header>
  <h1>NIFTY ORB Options Strategy: Original vs Tuned</h1>
  <p>3-Min ORB (Original) vs 10-Min ORB (Tuned) &mdash; Backtest Sep 2025 &ndash; Feb 2026 (121 trading days)</p>
  <div class="legend" style="margin-top: 16px;">
    <div class="legend-item"><div class="legend-dot" style="background:var(--orig)"></div> Original</div>
    <div class="legend-item"><div class="legend-dot" style="background:var(--tuned)"></div> Tuned</div>
  </div>
</header>

<!-- Strategy Flow -->
<div class="strategy-flow">
  <h2>How the Strategy Works</h2>
  <div class="flow-steps">
    <div class="flow-step">
      <div class="step-num">1</div>
      <h4>Opening Range</h4>
      <p>Record H3 (high) and L3 (low) of first N candles (3 or 10)</p>
    </div>
    <div class="flow-step">
      <div class="step-num">2</div>
      <h4>Breakout</h4>
      <p>Close &gt; H3 = CALL<br>Close &lt; L3 = PUT<br>Set H1/L1 levels</p>
    </div>
    <div class="flow-step">
      <div class="step-num">3</div>
      <h4>Entry</h4>
      <p>Buy ITM option when price crosses H1 (call) or L1 (put). Filters must pass.</p>
    </div>
    <div class="flow-step">
      <div class="step-num">4</div>
      <h4>Regime A</h4>
      <p>Candle-based SL on underlying at L1 (call) / H1 (put). No trailing yet.</p>
    </div>
    <div class="flow-step">
      <div class="step-num">5</div>
      <h4>Regime B</h4>
      <p>After hitting T1 gain, switch to premium trailing ladder. Let winners run.</p>
    </div>
  </div>
</div>

<!-- Parameter Comparison -->
<div class="params-section">
  <div class="param-card original">
    <h3><span class="dot"></span> Original Configuration</h3>
    <table class="param-table">
      <tr><td>ORB Candles</td><td>3 (09:15&ndash;09:18)</td></tr>
      <tr><td>RSI Filter</td><td>40 &ndash; 65 (active)</td></tr>
      <tr><td>SuperTrend</td><td>Period 10, Mult 3.0</td></tr>
      <tr><td>Re-entries per side</td><td>4</td></tr>
      <tr><td>Trailing Ladder Step</td><td>30 points</td></tr>
      <tr><td>T1 (breakeven)</td><td>+30</td></tr>
      <tr><td>T5 (full exit)</td><td>+150</td></tr>
      <tr><td>ITM Offset</td><td>200 pts</td></tr>
      <tr><td>No entry after</td><td>11:30</td></tr>
      <tr><td>Force exit</td><td>15:15</td></tr>
    </table>
  </div>
  <div class="param-card tuned">
    <h3><span class="dot"></span> Tuned Configuration</h3>
    <table class="param-table">
      <tr class="changed"><td>ORB Candles</td><td>10 (09:15&ndash;09:25)</td></tr>
      <tr class="changed"><td>RSI Filter</td><td>DISABLED (0 &ndash; 100)</td></tr>
      <tr class="changed"><td>SuperTrend</td><td>Period 14, Mult 3.0</td></tr>
      <tr class="changed"><td>Re-entries per side</td><td>1</td></tr>
      <tr class="changed"><td>Trailing Ladder Step</td><td>40 points</td></tr>
      <tr class="changed"><td>T1 (breakeven)</td><td>+40</td></tr>
      <tr class="changed"><td>T5 (full exit)</td><td>+200</td></tr>
      <tr><td>ITM Offset</td><td>200 pts</td></tr>
      <tr class="changed"><td>No entry after</td><td>12:00</td></tr>
      <tr><td>Force exit</td><td>15:15</td></tr>
    </table>
  </div>
</div>

<!-- Trailing Ladder Visual -->
<div class="ladder-section">
  <div class="ladder-card">
    <h3 style="color:var(--orig)">Original Trailing Ladder (30-step)</h3>
    <div class="ladder-visual">
      <div class="ladder-rung"><span class="ladder-label">T1 +30</span><div class="ladder-bar" style="width:20%;background:var(--orig)">+30</div><span class="ladder-action">Trail SL to cost</span></div>
      <div class="ladder-rung"><span class="ladder-label">T2 +60</span><div class="ladder-bar" style="width:40%;background:var(--orig)">+60</div><span class="ladder-action">Trail SL to +30</span></div>
      <div class="ladder-rung"><span class="ladder-label">T3 +90</span><div class="ladder-bar" style="width:60%;background:var(--orig)">+90</div><span class="ladder-action">Trail SL to +60</span></div>
      <div class="ladder-rung"><span class="ladder-label">T4 +120</span><div class="ladder-bar" style="width:80%;background:var(--orig)">+120</div><span class="ladder-action">Trail SL to +90</span></div>
      <div class="ladder-rung"><span class="ladder-label">T5 +150</span><div class="ladder-bar" style="width:100%;background:var(--orig)">+150</div><span class="ladder-action">FULL EXIT</span></div>
    </div>
  </div>
  <div class="ladder-card">
    <h3 style="color:var(--tuned)">Tuned Trailing Ladder (40-step)</h3>
    <div class="ladder-visual">
      <div class="ladder-rung"><span class="ladder-label">T1 +40</span><div class="ladder-bar" style="width:20%;background:var(--tuned)">+40</div><span class="ladder-action">Trail SL to cost</span></div>
      <div class="ladder-rung"><span class="ladder-label">T2 +80</span><div class="ladder-bar" style="width:40%;background:var(--tuned)">+80</div><span class="ladder-action">Trail SL to +40</span></div>
      <div class="ladder-rung"><span class="ladder-label">T3 +120</span><div class="ladder-bar" style="width:60%;background:var(--tuned)">+120</div><span class="ladder-action">Trail SL to +80</span></div>
      <div class="ladder-rung"><span class="ladder-label">T4 +160</span><div class="ladder-bar" style="width:80%;background:var(--tuned)">+160</div><span class="ladder-action">Trail SL to +120</span></div>
      <div class="ladder-rung"><span class="ladder-label">T5 +200</span><div class="ladder-bar" style="width:100%;background:var(--tuned)">+200</div><span class="ladder-action">FULL EXIT</span></div>
    </div>
  </div>
</div>

<!-- Key Metrics -->
<h2 style="color:var(--accent); margin-top: 32px;">Performance Comparison</h2>
<div id="metricsGrid" class="metrics-grid"></div>

<!-- Key Insights -->
<div class="insights">
  <div class="insight-box">
    <h4>10-Candle ORB is Key</h4>
    <p>Wider opening range (10 min vs 3 min) filters out false breakouts dramatically. This single change is the biggest contributor to the +Rs 23K swing in net P&amp;L.</p>
  </div>
  <div class="insight-box">
    <h4>Fewer Re-entries Win</h4>
    <p>Reducing re-entries from 4 to 1 eliminated loss-chasing. Re-entry #2+ were almost always losers &mdash; getting stopped out twice signals the breakout failed.</p>
  </div>
  <div class="insight-box">
    <h4>Wider Ladder = Better R:R</h4>
    <p>The 40-step ladder lets winners run further, improving reward-to-risk from 1.85 to 3.91 while keeping average losses smaller (Rs 420 vs Rs 605).</p>
  </div>
  <div class="insight-box">
    <h4>Net Profitable</h4>
    <p>The tuned strategy nets +Rs 9,446 after all charges (Zerodha). Gross P&amp;L of +Rs 13,618 with Sharpe ratio of 1.40. Profit factor 1.51.</p>
  </div>
</div>

<!-- Equity Curve Chart -->
<div class="chart-section">
  <h2>Equity Curve</h2>
  <div class="chart-container"><canvas id="equityChart"></canvas></div>
</div>

<!-- Daily P&L Chart -->
<div class="chart-section">
  <h2>Daily P&L</h2>
  <div class="chart-container"><canvas id="dailyPnlChart"></canvas></div>
</div>

<!-- Exit Reasons -->
<div class="exit-section">
  <div class="exit-card">
    <h3 style="color:var(--orig)">Original Exit Reasons</h3>
    <canvas id="exitOrigChart"></canvas>
  </div>
  <div class="exit-card">
    <h3 style="color:var(--tuned)">Tuned Exit Reasons</h3>
    <canvas id="exitTunedChart"></canvas>
  </div>
</div>

<!-- Trade Log -->
<div class="trade-table-wrapper">
  <h3>Trade Log</h3>
  <div class="tab-buttons">
    <button class="tab-btn active" onclick="showTrades('tuned', this)">Tuned (61 trades)</button>
    <button class="tab-btn" onclick="showTrades('original', this)">Original (54 trades)</button>
  </div>
  <div id="tradeTableContainer"></div>
</div>

</div><!-- /container -->

<script>
const RAW = {"original":{"label":"Original (3-min ORB, RSI 40-65, ST 10/3, L30, re-entry 4)","metrics":{"total_trades":54,"winning_trades":11,"win_rate":20.4,"gross_pnl":-10044.0,"net_pnl":-13719.0,"charges":3675.0,"avg_win":1117.0,"avg_loss":-605.0,"rr":1.85,"pf":0.47,"max_dd":19689.0,"sharpe":-2.36},"daily_pnl":{"2025-12-03":-103.88,"2025-12-04":-258.21,"2025-12-09":-333.29,"2025-12-17":-182.31,"2025-12-18":-163.15,"2025-12-19":63.67,"2025-12-23":-445.64,"2025-12-24":45.68,"2025-12-26":112.93,"2026-01-05":-454.97,"2026-01-06":-454.5,"2026-01-07":-39.26,"2026-01-12":-457.1,"2026-01-13":1710.17,"2026-01-14":-628.14,"2026-01-16":1322.41,"2026-01-19":269.8,"2026-01-20":3697.88,"2026-01-21":-2127.6,"2026-01-22":-1967.25,"2026-01-27":-1416.86,"2026-01-28":-1185.8,"2026-01-30":-970.93,"2026-02-01":-269.31,"2026-02-02":-2035.17,"2026-02-03":-2484.88,"2026-02-04":301.58,"2026-02-05":-1804.28,"2026-02-10":-944.85,"2026-02-11":-841.91,"2026-02-12":-727.91,"2026-02-13":-1007.93,"2026-02-16":-127.36,"2026-02-17":-311.39,"2026-02-18":-1767.22,"2026-02-19":3960.99,"2026-02-23":-1692.68},"equity":{"2025-12-01":0,"2025-12-02":0,"2025-12-03":-103.88,"2025-12-04":-362.09,"2025-12-05":-362.09,"2025-12-08":-362.09,"2025-12-09":-695.38,"2025-12-10":-695.38,"2025-12-11":-695.38,"2025-12-12":-695.38,"2025-12-15":-695.38,"2025-12-16":-695.38,"2025-12-17":-877.69,"2025-12-18":-1040.84,"2025-12-19":-977.17,"2025-12-22":-977.17,"2025-12-23":-1422.81,"2025-12-24":-1377.13,"2025-12-26":-1264.2,"2025-12-29":-1264.2,"2025-12-30":-1264.2,"2025-12-31":-1264.2,"2026-01-01":-1264.2,"2026-01-02":-1264.2,"2026-01-05":-1719.17,"2026-01-06":-2173.67,"2026-01-07":-2212.92,"2026-01-08":-2212.92,"2026-01-09":-2212.92,"2026-01-12":-2670.02,"2026-01-13":-959.85,"2026-01-14":-1587.99,"2026-01-16":-265.58,"2026-01-19":4.21,"2026-01-20":3702.09,"2026-01-21":1574.5,"2026-01-22":-392.76,"2026-01-23":-392.76,"2026-01-27":-1809.62,"2026-01-28":-2995.42,"2026-01-29":-2995.42,"2026-01-30":-3966.35,"2026-02-01":-4235.66,"2026-02-02":-6270.83,"2026-02-03":-8755.71,"2026-02-04":-8454.13,"2026-02-05":-10258.41,"2026-02-06":-10258.41,"2026-02-09":-10258.41,"2026-02-10":-11203.26,"2026-02-11":-12045.17,"2026-02-12":-12773.08,"2026-02-13":-13781.01,"2026-02-16":-13908.37,"2026-02-17":-14219.75,"2026-02-18":-15986.97,"2026-02-19":-12025.98,"2026-02-20":-12025.98,"2026-02-23":-13718.66},"exit_reasons":{"FORCE_EXIT":3,"PREMIUM_TRAIL_SL":12,"CANDLE_SL":37,"PREMIUM_TARGET":2},"trades":[{"date":"2025-12-03","entry_time":"09:46","exit_time":"15:15","side":"PUT","symbol":"NIFTY26200PE","entry_premium":444.0,"exit_premium":442.5,"gross":-38.0,"net":-104.0,"reason":"FORCE_EXIT"},{"date":"2025-12-04","entry_time":"10:16","exit_time":"14:58","side":"CALL","symbol":"NIFTY25800CE","entry_premium":952.0,"exit_premium":945.2,"gross":-170.0,"net":-258.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2025-12-09","entry_time":"10:01","exit_time":"10:19","side":"PUT","symbol":"NIFTY26050PE","entry_premium":452.05,"exit_premium":448.05,"gross":-100.0,"net":-167.0,"reason":"CANDLE_SL"},{"date":"2025-12-09","entry_time":"10:34","exit_time":"11:09","side":"PUT","symbol":"NIFTY26050PE","entry_premium":452.05,"exit_premium":448.05,"gross":-100.0,"net":-167.0,"reason":"CANDLE_SL"},{"date":"2025-12-17","entry_time":"09:29","exit_time":"09:44","side":"CALL","symbol":"NIFTY25700CE","entry_premium":813.8,"exit_premium":809.8,"gross":-100.0,"net":-182.0,"reason":"CANDLE_SL"},{"date":"2025-12-18","entry_time":"09:52","exit_time":"10:11","side":"PUT","symbol":"NIFTY25950PE","entry_premium":371.3,"exit_premium":367.3,"gross":-100.0,"net":-163.0,"reason":"CANDLE_SL"},{"date":"2025-12-19","entry_time":"09:44","exit_time":"15:15","side":"CALL","symbol":"NIFTY25700CE","entry_premium":841.1,"exit_premium":847.0,"gross":147.0,"net":64.0,"reason":"FORCE_EXIT"},{"date":"2025-12-23","entry_time":"09:34","exit_time":"09:56","side":"PUT","symbol":"NIFTY26400PE","entry_premium":379.95,"exit_premium":364.65,"gross":-383.0,"net":-446.0,"reason":"CANDLE_SL"},{"date":"2025-12-24","entry_time":"09:34","exit_time":"11:43","side":"CALL","symbol":"NIFTY25950CE","entry_premium":824.0,"exit_premium":829.15,"gross":129.0,"net":46.0,"reason":"CANDLE_SL"},{"date":"2025-12-26","entry_time":"09:58","exit_time":"15:15","side":"PUT","symbol":"NIFTY26300PE","entry_premium":366.6,"exit_premium":373.65,"gross":176.0,"net":113.0,"reason":"FORCE_EXIT"},{"date":"2026-01-05","entry_time":"09:25","exit_time":"10:10","side":"PUT","symbol":"NIFTY26550PE","entry_premium":393.7,"exit_premium":378.05,"gross":-391.0,"net":-455.0,"reason":"CANDLE_SL"},{"date":"2026-01-06","entry_time":"09:57","exit_time":"10:21","side":"CALL","symbol":"NIFTY26000CE","entry_premium":728.5,"exit_premium":713.45,"gross":-376.0,"net":-454.0,"reason":"CANDLE_SL"},{"date":"2026-01-07","entry_time":"09:53","exit_time":"09:56","side":"PUT","symbol":"NIFTY26350PE","entry_premium":393.0,"exit_premium":394.0,"gross":25.0,"net":-39.0,"reason":"CANDLE_SL"},{"date":"2026-01-12","entry_time":"09:35","exit_time":"12:17","side":"PUT","symbol":"NIFTY25850PE","entry_premium":413.9,"exit_premium":398.2,"gross":-392.0,"net":-457.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-13","entry_time":"09:21","exit_time":"10:23","side":"PUT","symbol":"NIFTY26100PE","entry_premium":428.0,"exit_premium":450.8,"gross":570.0,"net":503.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-13","entry_time":"10:35","exit_time":"14:37","side":"PUT","symbol":"NIFTY26100PE","entry_premium":447.75,"exit_premium":498.75,"gross":1275.0,"net":1207.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-14","entry_time":"09:23","exit_time":"09:44","side":"CALL","symbol":"NIFTY25450CE","entry_premium":680.0,"exit_premium":678.0,"gross":-50.0,"net":-127.0,"reason":"CANDLE_SL"},{"date":"2026-01-14","entry_time":"09:54","exit_time":"10:08","side":"CALL","symbol":"NIFTY25450CE","entry_premium":642.5,"exit_premium":638.5,"gross":-100.0,"net":-175.0,"reason":"CANDLE_SL"},{"date":"2026-01-14","entry_time":"11:20","exit_time":"13:32","side":"CALL","symbol":"NIFTY25450CE","entry_premium":688.0,"exit_premium":678.0,"gross":-250.0,"net":-327.0,"reason":"CANDLE_SL"},{"date":"2026-01-16","entry_time":"09:57","exit_time":"11:12","side":"CALL","symbol":"NIFTY25500CE","entry_premium":658.0,"exit_premium":714.0,"gross":1400.0,"net":1322.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-19","entry_time":"10:08","exit_time":"11:00","side":"PUT","symbol":"NIFTY25850PE","entry_premium":447.0,"exit_premium":447.65,"gross":16.0,"net":-50.0,"reason":"CANDLE_SL"},{"date":"2026-01-19","entry_time":"11:21","exit_time":"12:17","side":"PUT","symbol":"NIFTY25850PE","entry_premium":424.7,"exit_premium":440.15,"gross":386.0,"net":320.0,"reason":"CANDLE_SL"},{"date":"2026-01-20","entry_time":"09:51","exit_time":"15:10","side":"PUT","symbol":"NIFTY25800PE","entry_premium":457.7,"exit_premium":608.5,"gross":3770.0,"net":3698.0,"reason":"PREMIUM_TARGET"},{"date":"2026-01-21","entry_time":"09:19","exit_time":"10:21","side":"CALL","symbol":"NIFTY24950CE","entry_premium":708.05,"exit_premium":625.95,"gross":-2052.0,"net":-2128.0,"reason":"CANDLE_SL"},{"date":"2026-01-22","entry_time":"09:52","exit_time":"10:20","side":"CALL","symbol":"NIFTY25150CE","entry_premium":666.35,"exit_premium":590.6,"gross":-1894.0,"net":-1967.0,"reason":"CANDLE_SL"},{"date":"2026-01-27","entry_time":"09:27","exit_time":"09:37","side":"PUT","symbol":"NIFTY25250PE","entry_premium":496.0,"exit_premium":442.0,"gross":-1350.0,"net":-1417.0,"reason":"CANDLE_SL"},{"date":"2026-01-28","entry_time":"09:32","exit_time":"09:38","side":"CALL","symbol":"NIFTY25050CE","entry_premium":657.75,"exit_premium":619.35,"gross":-960.0,"net":-1034.0,"reason":"CANDLE_SL"},{"date":"2026-01-28","entry_time":"11:25","exit_time":"11:42","side":"CALL","symbol":"NIFTY25050CE","entry_premium":619.0,"exit_premium":615.9,"gross":-78.0,"net":-151.0,"reason":"CANDLE_SL"},{"date":"2026-01-30","entry_time":"09:38","exit_time":"11:10","side":"CALL","symbol":"NIFTY25050CE","entry_premium":576.0,"exit_premium":540.0,"gross":-900.0,"net":-971.0,"reason":"CANDLE_SL"},{"date":"2026-02-01","entry_time":"10:17","exit_time":"11:41","side":"CALL","symbol":"NIFTY25150CE","entry_premium":516.7,"exit_premium":508.7,"gross":-200.0,"net":-269.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-02","entry_time":"09:21","exit_time":"10:00","side":"CALL","symbol":"NIFTY24600CE","entry_premium":549.45,"exit_premium":542.3,"gross":-179.0,"net":-250.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-02","entry_time":"10:40","exit_time":"10:57","side":"CALL","symbol":"NIFTY24600CE","entry_premium":566.35,"exit_premium":497.7,"gross":-1716.0,"net":-1786.0,"reason":"CANDLE_SL"},{"date":"2026-02-03","entry_time":"09:59","exit_time":"10:26","side":"PUT","symbol":"NIFTY26500PE","entry_premium":816.75,"exit_premium":730.5,"gross":-2156.0,"net":-2236.0,"reason":"CANDLE_SL"},{"date":"2026-02-03","entry_time":"10:54","exit_time":"10:55","side":"PUT","symbol":"NIFTY26500PE","entry_premium":738.7,"exit_premium":731.9,"gross":-170.0,"net":-249.0,"reason":"CANDLE_SL"},{"date":"2026-02-04","entry_time":"09:23","exit_time":"10:23","side":"CALL","symbol":"NIFTY25500CE","entry_premium":475.5,"exit_premium":470.5,"gross":-125.0,"net":-193.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-04","entry_time":"10:43","exit_time":"15:08","side":"CALL","symbol":"NIFTY25500CE","entry_premium":469.5,"exit_premium":492.0,"gross":562.0,"net":494.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-05","entry_time":"09:58","exit_time":"10:22","side":"PUT","symbol":"NIFTY25950PE","entry_premium":408.9,"exit_premium":357.9,"gross":-1275.0,"net":-1338.0,"reason":"CANDLE_SL"},{"date":"2026-02-05","entry_time":"10:31","exit_time":"11:14","side":"PUT","symbol":"NIFTY25950PE","entry_premium":365.15,"exit_premium":359.0,"gross":-154.0,"net":-217.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-05","entry_time":"11:19","exit_time":"15:03","side":"PUT","symbol":"NIFTY25950PE","entry_premium":377.0,"exit_premium":369.55,"gross":-186.0,"net":-250.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-10","entry_time":"09:49","exit_time":"13:32","side":"CALL","symbol":"NIFTY25700CE","entry_premium":406.0,"exit_premium":370.75,"gross":-881.0,"net":-945.0,"reason":"CANDLE_SL"},{"date":"2026-02-11","entry_time":"09:44","exit_time":"09:55","side":"PUT","symbol":"NIFTY26200PE","entry_premium":295.1,"exit_premium":284.0,"gross":-278.0,"net":-337.0,"reason":"CANDLE_SL"},{"date":"2026-02-11","entry_time":"10:08","exit_time":"10:19","side":"PUT","symbol":"NIFTY26200PE","entry_premium":304.95,"exit_premium":287.15,"gross":-445.0,"net":-505.0,"reason":"CANDLE_SL"},{"date":"2026-02-12","entry_time":"09:40","exit_time":"09:49","side":"PUT","symbol":"NIFTY26100PE","entry_premium":294.7,"exit_premium":284.3,"gross":-260.0,"net":-320.0,"reason":"CANDLE_SL"},{"date":"2026-02-12","entry_time":"11:25","exit_time":"12:57","side":"PUT","symbol":"NIFTY26100PE","entry_premium":295.95,"exit_premium":282.0,"gross":-349.0,"net":-408.0,"reason":"CANDLE_SL"},{"date":"2026-02-13","entry_time":"10:01","exit_time":"10:33","side":"PUT","symbol":"NIFTY25750PE","entry_premium":254.2,"exit_premium":247.6,"gross":-165.0,"net":-223.0,"reason":"CANDLE_SL"},{"date":"2026-02-13","entry_time":"10:50","exit_time":"10:55","side":"PUT","symbol":"NIFTY25750PE","entry_premium":259.8,"exit_premium":246.45,"gross":-334.0,"net":-392.0,"reason":"CANDLE_SL"},{"date":"2026-02-13","entry_time":"11:04","exit_time":"12:02","side":"PUT","symbol":"NIFTY25750PE","entry_premium":264.1,"exit_premium":250.7,"gross":-335.0,"net":-393.0,"reason":"CANDLE_SL"},{"date":"2026-02-16","entry_time":"09:20","exit_time":"09:51","side":"CALL","symbol":"NIFTY25200CE","entry_premium":395.0,"exit_premium":370.15,"gross":-621.0,"net":-685.0,"reason":"CANDLE_SL"},{"date":"2026-02-16","entry_time":"09:55","exit_time":"11:46","side":"CALL","symbol":"NIFTY25200CE","entry_premium":394.7,"exit_premium":419.6,"gross":623.0,"net":557.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-17","entry_time":"09:32","exit_time":"09:33","side":"PUT","symbol":"NIFTY25850PE","entry_premium":306.55,"exit_premium":296.5,"gross":-251.0,"net":-311.0,"reason":"CANDLE_SL"},{"date":"2026-02-18","entry_time":"09:25","exit_time":"09:27","side":"PUT","symbol":"NIFTY25950PE","entry_premium":269.2,"exit_premium":256.25,"gross":-324.0,"net":-382.0,"reason":"CANDLE_SL"},{"date":"2026-02-18","entry_time":"10:11","exit_time":"12:35","side":"PUT","symbol":"NIFTY25950PE","entry_premium":309.05,"exit_premium":256.0,"gross":-1326.0,"net":-1385.0,"reason":"CANDLE_SL"},{"date":"2026-02-19","entry_time":"09:29","exit_time":"12:01","side":"PUT","symbol":"NIFTY26050PE","entry_premium":262.5,"exit_premium":423.5,"gross":4025.0,"net":3961.0,"reason":"PREMIUM_TARGET"},{"date":"2026-02-23","entry_time":"09:38","exit_time":"10:38","side":"CALL","symbol":"NIFTY25500CE","entry_premium":293.05,"exit_premium":227.65,"gross":-1635.0,"net":-1693.0,"reason":"CANDLE_SL"}]},"tuned":{"label":"Tuned (10-min ORB, RSI off, ST 14/3, L40, re-entry 1)","metrics":{"total_trades":61,"winning_trades":17,"win_rate":27.9,"gross_pnl":13618.0,"net_pnl":9446.0,"charges":4171.0,"avg_win":1643.0,"avg_loss":-420.0,"rr":3.91,"pf":1.51,"max_dd":8576.0,"sharpe":1.4},"daily_pnl":{"2025-12-02":-439.1,"2025-12-03":221.24,"2025-12-04":-92.18,"2025-12-08":2771.28,"2025-12-09":853.74,"2025-12-17":-183.5,"2025-12-18":-163.15,"2025-12-19":-391.06,"2025-12-23":-962.46,"2025-12-24":-365.51,"2025-12-26":278.0,"2026-01-02":-264.41,"2026-01-05":197.89,"2026-01-06":-542.03,"2026-01-07":-39.26,"2026-01-08":2120.22,"2026-01-09":1460.01,"2026-01-12":-276.3,"2026-01-13":548.29,"2026-01-14":-463.05,"2026-01-16":552.37,"2026-01-19":169.76,"2026-01-20":4051.93,"2026-01-21":1698.34,"2026-01-22":-530.46,"2026-01-23":2536.78,"2026-01-27":185.98,"2026-01-30":-970.93,"2026-02-01":-417.61,"2026-02-02":-1434.96,"2026-02-03":-1492.05,"2026-02-04":16.43,"2026-02-05":-370.86,"2026-02-06":-1048.25,"2026-02-10":-877.32,"2026-02-11":-934.45,"2026-02-12":-452.06,"2026-02-13":-593.48,"2026-02-16":3406.99,"2026-02-17":-652.22,"2026-02-18":-1929.12,"2026-02-19":5018.29,"2026-02-23":-755.42},"equity":{"2025-12-01":0,"2025-12-02":-439.1,"2025-12-03":-217.86,"2025-12-04":-310.04,"2025-12-05":-310.04,"2025-12-08":2461.24,"2025-12-09":3314.98,"2025-12-10":3314.98,"2025-12-11":3314.98,"2025-12-12":3314.98,"2025-12-15":3314.98,"2025-12-16":3314.98,"2025-12-17":3131.48,"2025-12-18":2968.33,"2025-12-19":2577.27,"2025-12-22":2577.27,"2025-12-23":1614.82,"2025-12-24":1249.3,"2025-12-26":1527.3,"2025-12-29":1527.3,"2025-12-30":1527.3,"2025-12-31":1527.3,"2026-01-01":1527.3,"2026-01-02":1262.89,"2026-01-05":1460.78,"2026-01-06":918.75,"2026-01-07":879.5,"2026-01-08":2999.71,"2026-01-09":4459.72,"2026-01-12":4183.42,"2026-01-13":4731.72,"2026-01-14":4268.66,"2026-01-16":4821.04,"2026-01-19":4990.8,"2026-01-20":9042.73,"2026-01-21":10741.07,"2026-01-22":10210.61,"2026-01-23":12747.39,"2026-01-27":12933.37,"2026-01-28":12933.37,"2026-01-29":12933.37,"2026-01-30":11962.44,"2026-02-01":11544.83,"2026-02-02":10109.87,"2026-02-03":8617.82,"2026-02-04":8634.24,"2026-02-05":8263.38,"2026-02-06":7215.14,"2026-02-09":7215.14,"2026-02-10":6337.82,"2026-02-11":5403.37,"2026-02-12":4951.31,"2026-02-13":4357.83,"2026-02-16":7764.82,"2026-02-17":7112.6,"2026-02-18":5183.48,"2026-02-19":10201.77,"2026-02-20":10201.77,"2026-02-23":9446.36},"exit_reasons":{"CANDLE_SL":37,"FORCE_EXIT":11,"PREMIUM_TRAIL_SL":12,"PREMIUM_TARGET":1},"trades":[{"date":"2025-12-02","entry_time":"09:51","exit_time":"10:42","side":"PUT","symbol":"NIFTY26300PE","entry_premium":422.0,"exit_premium":413.65,"gross":-209.0,"net":-274.0,"reason":"CANDLE_SL"},{"date":"2025-12-02","entry_time":"10:46","exit_time":"10:51","side":"PUT","symbol":"NIFTY26300PE","entry_premium":417.65,"exit_premium":413.65,"gross":-100.0,"net":-165.0,"reason":"CANDLE_SL"},{"date":"2025-12-03","entry_time":"09:27","exit_time":"15:15","side":"PUT","symbol":"NIFTY26200PE","entry_premium":431.0,"exit_premium":442.5,"gross":288.0,"net":221.0,"reason":"FORCE_EXIT"},{"date":"2025-12-04","entry_time":"10:16","exit_time":"13:36","side":"CALL","symbol":"NIFTY25800CE","entry_premium":952.0,"exit_premium":951.85,"gross":-4.0,"net":-92.0,"reason":"CANDLE_SL"},{"date":"2025-12-08","entry_time":"09:36","exit_time":"15:15","side":"PUT","symbol":"NIFTY26350PE","entry_premium":379.45,"exit_premium":493.0,"gross":2839.0,"net":2771.0,"reason":"FORCE_EXIT"},{"date":"2025-12-09","entry_time":"09:30","exit_time":"15:15","side":"PUT","symbol":"NIFTY26050PE","entry_premium":411.25,"exit_premium":448.05,"gross":920.0,"net":854.0,"reason":"FORCE_EXIT"},{"date":"2025-12-17","entry_time":"09:37","exit_time":"09:40","side":"CALL","symbol":"NIFTY25700CE","entry_premium":841.2,"exit_premium":837.2,"gross":-100.0,"net":-184.0,"reason":"CANDLE_SL"},{"date":"2025-12-18","entry_time":"09:43","exit_time":"10:11","side":"PUT","symbol":"NIFTY25950PE","entry_premium":371.3,"exit_premium":367.3,"gross":-100.0,"net":-163.0,"reason":"CANDLE_SL"},{"date":"2025-12-19","entry_time":"09:30","exit_time":"10:06","side":"CALL","symbol":"NIFTY25700CE","entry_premium":832.0,"exit_premium":827.0,"gross":-125.0,"net":-208.0,"reason":"CANDLE_SL"},{"date":"2025-12-19","entry_time":"10:27","exit_time":"11:27","side":"CALL","symbol":"NIFTY25700CE","entry_premium":829.4,"exit_premium":825.4,"gross":-100.0,"net":-183.0,"reason":"CANDLE_SL"},{"date":"2025-12-23","entry_time":"09:30","exit_time":"14:15","side":"PUT","symbol":"NIFTY26400PE","entry_premium":380.3,"exit_premium":344.3,"gross":-900.0,"net":-962.0,"reason":"CANDLE_SL"},{"date":"2025-12-24","entry_time":"09:33","exit_time":"09:39","side":"CALL","symbol":"NIFTY25950CE","entry_premium":824.0,"exit_premium":820.0,"gross":-100.0,"net":-183.0,"reason":"CANDLE_SL"},{"date":"2025-12-24","entry_time":"09:45","exit_time":"09:46","side":"CALL","symbol":"NIFTY25950CE","entry_premium":824.0,"exit_premium":820.0,"gross":-100.0,"net":-183.0,"reason":"CANDLE_SL"},{"date":"2025-12-26","entry_time":"09:40","exit_time":"15:15","side":"PUT","symbol":"NIFTY26300PE","entry_premium":360.0,"exit_premium":373.65,"gross":341.0,"net":278.0,"reason":"FORCE_EXIT"},{"date":"2026-01-02","entry_time":"11:52","exit_time":"15:15","side":"CALL","symbol":"NIFTY25950CE","entry_premium":807.0,"exit_premium":799.7,"gross":-182.0,"net":-264.0,"reason":"FORCE_EXIT"},{"date":"2026-01-05","entry_time":"09:32","exit_time":"09:50","side":"PUT","symbol":"NIFTY26550PE","entry_premium":393.7,"exit_premium":404.2,"gross":262.0,"net":198.0,"reason":"CANDLE_SL"},{"date":"2026-01-06","entry_time":"09:56","exit_time":"10:21","side":"CALL","symbol":"NIFTY26000CE","entry_premium":732.0,"exit_premium":713.45,"gross":-464.0,"net":-542.0,"reason":"CANDLE_SL"},{"date":"2026-01-07","entry_time":"09:53","exit_time":"09:56","side":"PUT","symbol":"NIFTY26350PE","entry_premium":393.0,"exit_premium":394.0,"gross":25.0,"net":-39.0,"reason":"CANDLE_SL"},{"date":"2026-01-08","entry_time":"09:29","exit_time":"09:37","side":"PUT","symbol":"NIFTY26300PE","entry_premium":387.6,"exit_premium":378.05,"gross":-239.0,"net":-302.0,"reason":"CANDLE_SL"},{"date":"2026-01-08","entry_time":"10:07","exit_time":"15:15","side":"PUT","symbol":"NIFTY26300PE","entry_premium":387.9,"exit_premium":487.5,"gross":2490.0,"net":2423.0,"reason":"FORCE_EXIT"},{"date":"2026-01-09","entry_time":"09:34","exit_time":"09:44","side":"PUT","symbol":"NIFTY26050PE","entry_premium":374.0,"exit_premium":358.1,"gross":-397.0,"net":-460.0,"reason":"CANDLE_SL"},{"date":"2026-01-09","entry_time":"10:57","exit_time":"15:15","side":"PUT","symbol":"NIFTY26050PE","entry_premium":369.25,"exit_premium":448.7,"gross":1986.0,"net":1920.0,"reason":"FORCE_EXIT"},{"date":"2026-01-12","entry_time":"09:26","exit_time":"12:14","side":"PUT","symbol":"NIFTY25850PE","entry_premium":418.65,"exit_premium":410.2,"gross":-211.0,"net":-276.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-13","entry_time":"09:27","exit_time":"10:26","side":"PUT","symbol":"NIFTY26100PE","entry_premium":449.95,"exit_premium":445.35,"gross":-115.0,"net":-182.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-13","entry_time":"10:35","exit_time":"14:47","side":"PUT","symbol":"NIFTY26100PE","entry_premium":447.75,"exit_premium":479.65,"gross":797.0,"net":730.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-14","entry_time":"09:55","exit_time":"09:56","side":"CALL","symbol":"NIFTY25450CE","entry_premium":642.5,"exit_premium":638.5,"gross":-100.0,"net":-175.0,"reason":"CANDLE_SL"},{"date":"2026-01-14","entry_time":"11:18","exit_time":"11:25","side":"CALL","symbol":"NIFTY25450CE","entry_premium":692.45,"exit_premium":684.0,"gross":-211.0,"net":-288.0,"reason":"CANDLE_SL"},{"date":"2026-01-16","entry_time":"09:53","exit_time":"11:58","side":"CALL","symbol":"NIFTY25500CE","entry_premium":653.95,"exit_premium":679.1,"gross":629.0,"net":552.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-19","entry_time":"10:01","exit_time":"11:00","side":"PUT","symbol":"NIFTY25850PE","entry_premium":451.0,"exit_premium":447.65,"gross":-84.0,"net":-150.0,"reason":"CANDLE_SL"},{"date":"2026-01-19","entry_time":"11:20","exit_time":"12:17","side":"PUT","symbol":"NIFTY25850PE","entry_premium":424.7,"exit_premium":440.15,"gross":386.0,"net":320.0,"reason":"CANDLE_SL"},{"date":"2026-01-20","entry_time":"09:27","exit_time":"15:15","side":"PUT","symbol":"NIFTY25800PE","entry_premium":439.7,"exit_premium":604.65,"gross":4124.0,"net":4052.0,"reason":"FORCE_EXIT"},{"date":"2026-01-21","entry_time":"10:23","exit_time":"11:01","side":"PUT","symbol":"NIFTY25350PE","entry_premium":423.1,"exit_premium":493.75,"gross":1766.0,"net":1698.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-22","entry_time":"09:27","exit_time":"10:20","side":"CALL","symbol":"NIFTY25150CE","entry_premium":608.9,"exit_premium":590.6,"gross":-457.0,"net":-530.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-23","entry_time":"11:38","exit_time":"15:15","side":"PUT","symbol":"NIFTY25550PE","entry_premium":461.7,"exit_premium":566.0,"gross":2608.0,"net":2537.0,"reason":"FORCE_EXIT"},{"date":"2026-01-27","entry_time":"09:44","exit_time":"10:41","side":"CALL","symbol":"NIFTY24850CE","entry_premium":672.15,"exit_premium":690.0,"gross":446.0,"net":369.0,"reason":"CANDLE_SL"},{"date":"2026-01-27","entry_time":"11:43","exit_time":"13:39","side":"CALL","symbol":"NIFTY24850CE","entry_premium":635.95,"exit_premium":631.6,"gross":-109.0,"net":-183.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-01-30","entry_time":"09:38","exit_time":"11:10","side":"CALL","symbol":"NIFTY25050CE","entry_premium":576.0,"exit_premium":540.0,"gross":-900.0,"net":-971.0,"reason":"CANDLE_SL"},{"date":"2026-02-01","entry_time":"10:14","exit_time":"11:42","side":"CALL","symbol":"NIFTY25150CE","entry_premium":511.0,"exit_premium":497.05,"gross":-349.0,"net":-418.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-02","entry_time":"09:32","exit_time":"10:00","side":"CALL","symbol":"NIFTY24600CE","entry_premium":596.85,"exit_premium":542.3,"gross":-1364.0,"net":-1435.0,"reason":"CANDLE_SL"},{"date":"2026-02-03","entry_time":"09:35","exit_time":"09:52","side":"PUT","symbol":"NIFTY26500PE","entry_premium":778.65,"exit_premium":741.95,"gross":-917.0,"net":-997.0,"reason":"CANDLE_SL"},{"date":"2026-02-03","entry_time":"09:53","exit_time":"10:18","side":"PUT","symbol":"NIFTY26500PE","entry_premium":767.05,"exit_premium":750.45,"gross":-415.0,"net":-495.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-04","entry_time":"09:26","exit_time":"15:15","side":"CALL","symbol":"NIFTY25500CE","entry_premium":490.8,"exit_premium":494.2,"gross":85.0,"net":16.0,"reason":"FORCE_EXIT"},{"date":"2026-02-05","entry_time":"09:27","exit_time":"10:19","side":"PUT","symbol":"NIFTY25950PE","entry_premium":368.75,"exit_premium":364.65,"gross":-103.0,"net":-166.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-05","entry_time":"10:31","exit_time":"15:05","side":"PUT","symbol":"NIFTY25950PE","entry_premium":365.15,"exit_premium":359.45,"gross":-142.0,"net":-205.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-06","entry_time":"09:38","exit_time":"09:47","side":"PUT","symbol":"NIFTY25800PE","entry_premium":343.25,"exit_premium":329.85,"gross":-335.0,"net":-397.0,"reason":"CANDLE_SL"},{"date":"2026-02-06","entry_time":"10:03","exit_time":"11:10","side":"PUT","symbol":"NIFTY25800PE","entry_premium":351.6,"exit_premium":328.0,"gross":-590.0,"net":-652.0,"reason":"CANDLE_SL"},{"date":"2026-02-10","entry_time":"09:34","exit_time":"13:32","side":"CALL","symbol":"NIFTY25700CE","entry_premium":403.3,"exit_premium":370.75,"gross":-814.0,"net":-877.0,"reason":"CANDLE_SL"},{"date":"2026-02-11","entry_time":"09:39","exit_time":"09:55","side":"PUT","symbol":"NIFTY26200PE","entry_premium":298.85,"exit_premium":284.0,"gross":-371.0,"net":-431.0,"reason":"CANDLE_SL"},{"date":"2026-02-11","entry_time":"10:01","exit_time":"10:19","side":"PUT","symbol":"NIFTY26200PE","entry_premium":304.9,"exit_premium":287.15,"gross":-444.0,"net":-504.0,"reason":"CANDLE_SL"},{"date":"2026-02-12","entry_time":"09:27","exit_time":"09:48","side":"PUT","symbol":"NIFTY26100PE","entry_premium":297.15,"exit_premium":288.0,"gross":-229.0,"net":-289.0,"reason":"CANDLE_SL"},{"date":"2026-02-12","entry_time":"11:20","exit_time":"12:46","side":"PUT","symbol":"NIFTY26100PE","entry_premium":294.0,"exit_premium":289.85,"gross":-104.0,"net":-164.0,"reason":"CANDLE_SL"},{"date":"2026-02-13","entry_time":"09:35","exit_time":"10:33","side":"PUT","symbol":"NIFTY25750PE","entry_premium":253.35,"exit_premium":247.6,"gross":-144.0,"net":-202.0,"reason":"CANDLE_SL"},{"date":"2026-02-13","entry_time":"10:50","exit_time":"10:55","side":"PUT","symbol":"NIFTY25750PE","entry_premium":259.8,"exit_premium":246.45,"gross":-334.0,"net":-392.0,"reason":"CANDLE_SL"},{"date":"2026-02-16","entry_time":"09:31","exit_time":"09:43","side":"CALL","symbol":"NIFTY25200CE","entry_premium":408.25,"exit_premium":388.45,"gross":-495.0,"net":-559.0,"reason":"CANDLE_SL"},{"date":"2026-02-16","entry_time":"09:58","exit_time":"15:15","side":"CALL","symbol":"NIFTY25200CE","entry_premium":401.5,"exit_premium":562.95,"gross":4036.0,"net":3966.0,"reason":"FORCE_EXIT"},{"date":"2026-02-17","entry_time":"09:58","exit_time":"10:02","side":"CALL","symbol":"NIFTY25450CE","entry_premium":316.05,"exit_premium":304.0,"gross":-301.0,"net":-362.0,"reason":"CANDLE_SL"},{"date":"2026-02-17","entry_time":"10:08","exit_time":"10:44","side":"CALL","symbol":"NIFTY25450CE","entry_premium":313.85,"exit_premium":304.65,"gross":-230.0,"net":-290.0,"reason":"PREMIUM_TRAIL_SL"},{"date":"2026-02-18","entry_time":"09:55","exit_time":"11:34","side":"PUT","symbol":"NIFTY25950PE","entry_premium":306.0,"exit_premium":260.35,"gross":-1141.0,"net":-1200.0,"reason":"CANDLE_SL"},{"date":"2026-02-18","entry_time":"11:41","exit_time":"12:08","side":"PUT","symbol":"NIFTY25950PE","entry_premium":292.45,"exit_premium":265.65,"gross":-670.0,"net":-729.0,"reason":"CANDLE_SL"},{"date":"2026-02-19","entry_time":"09:28","exit_time":"12:13","side":"PUT","symbol":"NIFTY26050PE","entry_premium":262.85,"exit_premium":466.2,"gross":5084.0,"net":5018.0,"reason":"PREMIUM_TARGET"},{"date":"2026-02-23","entry_time":"09:27","exit_time":"09:39","side":"CALL","symbol":"NIFTY25500CE","entry_premium":298.0,"exit_premium":270.15,"gross":-696.0,"net":-755.0,"reason":"CANDLE_SL"}]}};

// Normalize DATA: new format uses dict-based daily_pnl/equity and entry_premium/exit_premium
const DATA = JSON.parse(JSON.stringify(RAW));
['original','tuned'].forEach(k => {
  const d = DATA[k];
  // Equity: dict â†’ sorted array (only include dates from Dec onwards for charts)
  const eqDates = Object.keys(d.equity).filter(dt => dt >= '2025-12-01').sort();
  d._eqDates = eqDates;
  d._eqValues = eqDates.map(dt => d.equity[dt]);
  // Daily PnL: merge all dates with activity
  const allPnlDates = new Set([...Object.keys(DATA.original.daily_pnl), ...Object.keys(DATA.tuned.daily_pnl)]);
  d._pnlDates = [...allPnlDates].sort();
  // Normalize trade fields
  d.trades.forEach(t => {
    if (t.entry_premium !== undefined) { t.entry = t.entry_premium; t.exit = t.exit_premium; }
  });
});
// Use the tuned equity dates (superset) for chart labels
const chartDates = DATA.tuned._eqDates;

// -- Metrics tiles --
const metricsConfig = [
  { label: 'Net P&L', key: 'net_pnl', fmt: v => (v >= 0 ? '+' : '') + v.toLocaleString('en-IN'), unit: 'Rs', better: 'higher' },
  { label: 'Gross P&L', key: 'gross_pnl', fmt: v => (v >= 0 ? '+' : '') + v.toLocaleString('en-IN'), unit: 'Rs', better: 'higher' },
  { label: 'Total Trades', key: 'total_trades', fmt: v => v, unit: '', better: 'lower' },
  { label: 'Win Rate', key: 'win_rate', fmt: v => v + '%', unit: '', better: 'higher' },
  { label: 'Reward : Risk', key: 'rr', fmt: v => v.toFixed(2), unit: '', better: 'higher' },
  { label: 'Profit Factor', key: 'pf', fmt: v => v.toFixed(2), unit: '', better: 'higher' },
  { label: 'Avg Win', key: 'avg_win', fmt: v => (v >= 0 ? '+' : '') + v.toLocaleString('en-IN'), unit: 'Rs', better: 'higher' },
  { label: 'Avg Loss', key: 'avg_loss', fmt: v => v.toLocaleString('en-IN'), unit: 'Rs', better: 'higher' },
  { label: 'Max Drawdown', key: 'max_dd', fmt: v => v.toLocaleString('en-IN'), unit: 'Rs', better: 'lower' },
  { label: 'Sharpe Ratio', key: 'sharpe', fmt: v => v.toFixed(2), unit: '', better: 'higher' },
];

const grid = document.getElementById('metricsGrid');
metricsConfig.forEach(mc => {
  const ov = DATA.original.metrics[mc.key];
  const tv = DATA.tuned.metrics[mc.key];
  const diff = tv - ov;
  const pct = ov !== 0 ? ((diff / Math.abs(ov)) * 100).toFixed(0) : 'N/A';
  const isGood = mc.better === 'higher' ? diff > 0 : diff < 0;
  const tile = document.createElement('div');
  tile.className = 'metric-tile';
  tile.innerHTML = `
    <div class="label">${mc.label}</div>
    <div class="values">
      <div><div class="val orig">${mc.fmt(ov)}</div><div class="val-label">Original</div></div>
      <div><div class="val tuned">${mc.fmt(tv)}</div><div class="val-label">Tuned</div></div>
    </div>
    ${diff !== 0 ? `<div class="improvement ${isGood ? 'positive' : 'negative'}">${isGood ? '\u2191' : '\u2193'} ${pct}%</div>` : ''}
  `;
  grid.appendChild(tile);
});

// -- Chart defaults --
Chart.defaults.color = '#8892a0';
Chart.defaults.borderColor = '#2a2d3a';
Chart.defaults.font.family = "'Segoe UI', system-ui, sans-serif";

// -- Equity Curve --
const eqLabels = chartDates;
new Chart(document.getElementById('equityChart'), {
  type: 'line',
  data: {
    labels: eqLabels,
    datasets: [
      { label: 'Original', data: eqLabels.map(d => DATA.original.equity[d] || 0), borderColor: '#e74c3c', backgroundColor: 'rgba(231,76,60,0.08)', fill: true, tension: 0.3, pointRadius: 0, borderWidth: 2 },
      { label: 'Tuned', data: eqLabels.map(d => DATA.tuned.equity[d] || 0), borderColor: '#2ecc71', backgroundColor: 'rgba(46,204,113,0.08)', fill: true, tension: 0.3, pointRadius: 0, borderWidth: 2 },
    ]
  },
  options: {
    responsive: true,
    interaction: { mode: 'index', intersect: false },
    plugins: { tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': Rs ' + ctx.parsed.y.toLocaleString('en-IN') } } },
    scales: {
      x: { ticks: { maxTicksLimit: 12 }, grid: { display: false } },
      y: { ticks: { callback: v => 'Rs ' + v.toLocaleString('en-IN') } }
    }
  }
});

// -- Daily P&L --
const allPnlDates = [...new Set([...Object.keys(RAW.original.daily_pnl), ...Object.keys(RAW.tuned.daily_pnl)])].filter(d => d >= '2025-12-01').sort();
const pnlLabels = allPnlDates;
const origPnl = allPnlDates.map(d => DATA.original.daily_pnl[d] || 0);
const tunedPnl = allPnlDates.map(d => DATA.tuned.daily_pnl[d] || 0);
new Chart(document.getElementById('dailyPnlChart'), {
  type: 'bar',
  data: {
    labels: pnlLabels,
    datasets: [
      { label: 'Original', data: origPnl, backgroundColor: origPnl.map(v => v >= 0 ? 'rgba(231,76,60,0.7)' : 'rgba(231,76,60,0.3)'), borderRadius: 3, barPercentage: 0.4 },
      { label: 'Tuned', data: tunedPnl, backgroundColor: tunedPnl.map(v => v >= 0 ? 'rgba(46,204,113,0.7)' : 'rgba(46,204,113,0.3)'), borderRadius: 3, barPercentage: 0.4 },
    ]
  },
  options: {
    responsive: true,
    interaction: { mode: 'index', intersect: false },
    plugins: { tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': Rs ' + ctx.parsed.y.toLocaleString('en-IN') } } },
    scales: {
      x: { ticks: { maxTicksLimit: 12 }, grid: { display: false } },
      y: { ticks: { callback: v => 'Rs ' + v.toLocaleString('en-IN') } }
    }
  }
});

// -- Exit Reason Donuts --
const exitColorMap = {
  'CANDLE_SL': '#e74c3c',
  'PREMIUM_TRAIL_SL': '#3b82f6',
  'FORCE_EXIT': '#f39c12',
  'PREMIUM_TARGET': '#2ecc71',
  'TIME_EXIT': '#9b59b6'
};
function exitDonut(canvasId, reasons) {
  const labels = Object.keys(reasons);
  const values = Object.values(reasons);
  const total = values.reduce((a, b) => a + b, 0);
  const colors = labels.map(l => exitColorMap[l] || '#888');
  new Chart(document.getElementById(canvasId), {
    type: 'doughnut',
    data: {
      labels: labels.map(l => l.replace(/_/g, ' ')),
      datasets: [{ data: values, backgroundColor: colors, borderWidth: 0, hoverOffset: 8 }]
    },
    options: {
      responsive: true,
      cutout: '55%',
      plugins: {
        legend: { position: 'bottom', labels: { padding: 16, font: { size: 12 } } },
        tooltip: { callbacks: { label: ctx => ctx.label + ': ' + ctx.parsed + ' (' + (ctx.parsed / total * 100).toFixed(1) + '%)' } },
        datalabels: { color: '#fff', font: { weight: 'bold', size: 13 }, formatter: (val) => (val / total * 100).toFixed(0) + '%' }
      }
    },
    plugins: [{
      id: 'percentLabels',
      afterDatasetsDraw(chart) {
        const { ctx } = chart;
        chart.data.datasets[0].data.forEach((val, i) => {
          const meta = chart.getDatasetMeta(0).data[i];
          if (!meta) return;
          const pct = (val / total * 100).toFixed(0) + '%';
          const { x, y } = meta.tooltipPosition();
          ctx.save();
          ctx.fillStyle = '#fff';
          ctx.font = 'bold 12px Segoe UI, system-ui, sans-serif';
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.fillText(pct, x, y);
          ctx.restore();
        });
      }
    }]
  });
}
exitDonut('exitOrigChart', DATA.original.exit_reasons);
exitDonut('exitTunedChart', DATA.tuned.exit_reasons);

// -- Trade Table --
function showTrades(which, btn) {
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  const trades = DATA[which].trades;
  const container = document.getElementById('tradeTableContainer');
  let html = `<table class="trades"><thead><tr>
    <th>Date</th><th>Entry</th><th>Exit</th><th>Side</th><th>Symbol</th>
    <th>Entry Rs</th><th>Exit Rs</th><th>Gross</th><th>Net</th><th>Exit Reason</th>
  </tr></thead><tbody>`;
  trades.forEach(t => {
    const cls = t.net >= 0 ? 'pnl-pos' : 'pnl-neg';
    const sideBadge = t.side === 'CALL' ? 'badge-call' : 'badge-put';
    html += `<tr>
      <td>${t.date}</td>
      <td>${t.entry_time}</td>
      <td>${t.exit_time}</td>
      <td><span class="badge ${sideBadge}">${t.side}</span></td>
      <td>${t.symbol}</td>
      <td>${t.entry.toFixed(1)}</td>
      <td>${t.exit.toFixed(1)}</td>
      <td class="${cls}">${t.gross >= 0 ? '+' : ''}${t.gross.toFixed(0)}</td>
      <td class="${cls}">${t.net >= 0 ? '+' : ''}${t.net.toFixed(0)}</td>
      <td><span class="badge badge-exit">${t.reason.replace(/_/g, ' ')}</span></td>
    </tr>`;
  });
  html += '</tbody></table>';
  container.innerHTML = html;
}
showTrades('tuned', document.querySelector('.tab-btn.active'));
</script>

</body>
</html>
